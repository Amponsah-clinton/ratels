{% extends "base.html" %}
{% load static %}

{% block title %}Contact & Secure Tips - RATEL Movement{% endblock %}

{% block content %}
<section class="contact-page">
    <div class="contact-container">

        <!-- Page Header -->
        <div class="contact-header">
            <span class="header-badge">Get in Touch</span>
            <h1>Contact & Secure Tips</h1>
            <p>Choose how you'd like to reach us. All communications are handled with discretion and care.</p>
        </div>

        <!-- Inquiry Type Cards -->
        <div class="inquiry-cards">
            <div class="inquiry-card active" data-type="general">
                <div class="card-radio"></div>
                <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                </div>
                <div class="card-content">
                    <h3>General Contact</h3>
                    <p>Questions, feedback, partnership inquiries</p>
                </div>
            </div>
            <div class="inquiry-card" data-type="media">
                <div class="card-radio"></div>
                <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5"/><rect x="2" y="6" width="14" height="12" rx="2"/></svg>
                </div>
                <div class="card-content">
                    <h3>Media Enquiries</h3>
                    <p>Press, interviews, official statements</p>
                </div>
            </div>
            <div class="inquiry-card" data-type="secure_tip">
                <div class="card-radio"></div>
                <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>
                </div>
                <div class="card-content">
                    <h3>Secure Tips</h3>
                    <p>Anonymous or confidential information</p>
                </div>
            </div>
            <div class="inquiry-card" data-type="encrypted">
                <div class="card-radio"></div>
                <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                </div>
                <div class="card-content">
                    <h3>Encrypted Contact</h3>
                    <p>End-to-end secure communication</p>
                </div>
            </div>
        </div>

        <!-- Form Container -->
        <div class="form-wrapper">
            <form id="contactForm" method="POST" action="{% url 'contact_submit' %}">
                {% csrf_token %}
                <input type="hidden" name="inquiry_type" id="inquiryType" value="general">

                <!-- Success/Error Messages -->
                <div id="formMessages" class="form-messages" style="display: none;"></div>

                <!-- ==================== GENERAL CONTACT FIELDS ==================== -->
                <div class="form-section active" id="section-general">
                    <div class="section-intro">
                        <h2>Send us a message</h2>
                        <p>We typically respond within 24-48 hours.</p>
                    </div>

                    <div class="fields-grid">
                        <div class="field">
                            <label for="gen_name">Full Name</label>
                            <input type="text" id="gen_name" name="full_name" required placeholder="Enter your full name">
                        </div>
                        <div class="field">
                            <label for="gen_email">Email Address</label>
                            <input type="email" id="gen_email" name="email" required placeholder="you@example.com">
                        </div>
                    </div>

                    <div class="field">
                        <label for="gen_phone">Phone Number <span class="optional">Optional</span></label>
                        <input type="tel" id="gen_phone" name="phone" placeholder="+234 800 000 0000">
                    </div>

                    <div class="field">
                        <label for="gen_subject">Subject</label>
                        <input type="text" id="gen_subject" name="subject" required placeholder="What is this regarding?">
                    </div>

                    <div class="field">
                        <label for="gen_message">Message</label>
                        <textarea id="gen_message" name="message" rows="5" required placeholder="Tell us what's on your mind..."></textarea>
                    </div>
                </div>

                <!-- ==================== MEDIA ENQUIRIES FIELDS ==================== -->
                <div class="form-section" id="section-media">
                    <div class="section-intro">
                        <h2>Media Request</h2>
                        <p>For journalists, reporters, and media professionals.</p>
                    </div>

                    <div class="fields-grid">
                        <div class="field">
                            <label for="media_name">Your Name</label>
                            <input type="text" id="media_name" name="media_name" placeholder="Full name">
                        </div>
                        <div class="field">
                            <label for="media_email">Email Address</label>
                            <input type="email" id="media_email" name="media_email" placeholder="your@media.com">
                        </div>
                    </div>

                    <div class="fields-grid">
                        <div class="field">
                            <label for="media_outlet">Media Outlet</label>
                            <input type="text" id="media_outlet" name="media_outlet" placeholder="e.g., BBC, CNN, Guardian">
                        </div>
                        <div class="field">
                            <label for="media_phone">Phone Number <span class="optional">Optional</span></label>
                            <input type="tel" id="media_phone" name="media_phone" placeholder="+234 800 000 0000">
                        </div>
                    </div>

                    <div class="fields-grid">
                        <div class="field">
                            <label for="story_type">Type of Request</label>
                            <div class="select-wrapper">
                                <input type="text" id="story_type_display" class="select-input" placeholder="Select request type..." readonly>
                                <input type="hidden" id="story_type" name="story_type" value="">
                                <svg class="select-arrow" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m6 9 6 6 6-6"/></svg>
                                <div class="select-dropdown">
                                    <div class="select-option" data-value="interview">Interview Request</div>
                                    <div class="select-option" data-value="statement">Official Statement</div>
                                    <div class="select-option" data-value="background">Background Information</div>
                                    <div class="select-option" data-value="footage">Footage / Images</div>
                                    <div class="select-option" data-value="other">Other</div>
                                </div>
                            </div>
                        </div>
                        <div class="field">
                            <label for="deadline">Deadline <span class="optional">Optional</span></label>
                            <input type="datetime-local" id="deadline" name="deadline">
                        </div>
                    </div>

                    <div class="field">
                        <label for="media_subject">Story Angle / Subject</label>
                        <input type="text" id="media_subject" name="media_subject" placeholder="What story are you working on?">
                    </div>

                    <div class="field">
                        <label for="media_message">Details</label>
                        <textarea id="media_message" name="media_message" rows="5" placeholder="Provide details about your request, specific questions, and relevant context..."></textarea>
                    </div>
                </div>

                <!-- ==================== SECURE TIPS FIELDS ==================== -->
                <div class="form-section" id="section-secure_tip">
                    <div class="section-intro">
                        <h2>Submit a Tip</h2>
                        <p>Share sensitive information securely. Anonymous submissions supported.</p>
                    </div>

                    <div class="info-box security">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                        <div>
                            <strong>Your Security Matters</strong>
                            <p>We do not log IP addresses for anonymous tips. For maximum security, use a VPN or Tor browser.</p>
                        </div>
                    </div>

                    <div class="field">
                        <label class="toggle-label">
                            <div class="toggle-switch">
                                <input type="checkbox" name="is_anonymous" id="isAnonymous" onchange="toggleAnonymousFields()">
                                <span class="toggle-slider"></span>
                            </div>
                            <span>Submit Anonymously</span>
                        </label>
                        <p class="field-hint">You'll receive a reference code to check for responses.</p>
                    </div>

                    <div id="tipContactFields">
                        <div class="fields-grid">
                            <div class="field">
                                <label for="tip_name">Your Name <span class="optional">Confidential</span></label>
                                <input type="text" id="tip_name" name="tip_name" placeholder="Your name (kept confidential)">
                            </div>
                            <div class="field">
                                <label for="tip_contact">Contact Info <span class="optional">For follow-up</span></label>
                                <input type="text" id="tip_contact" name="tip_contact" placeholder="Email or phone number">
                            </div>
                        </div>
                    </div>

                    <div class="field">
                        <label>Urgency Level</label>
                        <div class="urgency-options">
                            <label class="urgency-item">
                                <input type="radio" name="urgency_level" value="low">
                                <span class="urgency-label low">Low</span>
                            </label>
                            <label class="urgency-item">
                                <input type="radio" name="urgency_level" value="normal" checked>
                                <span class="urgency-label normal">Normal</span>
                            </label>
                            <label class="urgency-item">
                                <input type="radio" name="urgency_level" value="high">
                                <span class="urgency-label high">High</span>
                            </label>
                            <label class="urgency-item">
                                <input type="radio" name="urgency_level" value="critical">
                                <span class="urgency-label critical">Critical</span>
                            </label>
                        </div>
                    </div>

                    <div class="field">
                        <label for="tip_subject">Subject</label>
                        <input type="text" id="tip_subject" name="tip_subject" placeholder="Brief description of the tip">
                    </div>

                    <div class="field">
                        <label for="tip_message">Your Information</label>
                        <textarea id="tip_message" name="tip_message" rows="6" placeholder="Provide as much detail as possible: Who, What, When, Where, How..."></textarea>
                    </div>

                    <div class="field">
                        <label for="evidence_desc">Evidence Description <span class="optional">Optional</span></label>
                        <textarea id="evidence_desc" name="evidence_description" rows="3" placeholder="Describe any documents, photos, or evidence you have..."></textarea>
                    </div>
                </div>

                <!-- ==================== ENCRYPTED CONTACT FIELDS ==================== -->
                <div class="form-section" id="section-encrypted">
                    <div class="section-intro">
                        <h2>Encrypted Contact</h2>
                        <p>For those requiring end-to-end encrypted communication.</p>
                    </div>

                    <div class="secure-channels">
                        <h4>Our Secure Channels</h4>
                        <div class="channels-list">
                            <div class="channel">
                                <div class="channel-badge signal">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                                </div>
                                <div>
                                    <strong>Signal</strong>
                                    <span>Most recommended</span>
                                </div>
                            </div>
                            <div class="channel">
                                <div class="channel-badge proton">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                                </div>
                                <div>
                                    <strong>ProtonMail</strong>
                                    <span>Encrypted email</span>
                                </div>
                            </div>
                            <div class="channel">
                                <div class="channel-badge session">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                                </div>
                                <div>
                                    <strong>Session</strong>
                                    <span>No phone required</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="field">
                        <label for="secure_channel">Preferred Channel</label>
                        <div class="select-wrapper">
                            <input type="text" id="secure_channel_display" class="select-input" placeholder="Select your preferred channel..." readonly>
                            <input type="hidden" id="secure_channel" name="preferred_secure_channel" value="">
                            <svg class="select-arrow" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m6 9 6 6 6-6"/></svg>
                            <div class="select-dropdown">
                                <div class="select-option" data-value="signal">Signal</div>
                                <div class="select-option" data-value="protonmail">ProtonMail</div>
                                <div class="select-option" data-value="session">Session</div>
                                <div class="select-option" data-value="wire">Wire</div>
                                <div class="select-option" data-value="pgp_email">PGP Encrypted Email</div>
                                <div class="select-option" data-value="other">Other</div>
                            </div>
                        </div>
                    </div>

                    <div class="field">
                        <label for="secure_handle">Your Handle / Address</label>
                        <input type="text" id="secure_handle" name="secure_contact_handle" placeholder="Signal number, ProtonMail address, or Session ID">
                    </div>

                    <div class="field">
                        <label for="pgp_key">PGP Public Key <span class="optional">Optional</span></label>
                        <textarea id="pgp_key" name="pgp_public_key" rows="3" placeholder="Paste your PGP public key if you want encrypted responses..."></textarea>
                    </div>

                    <div class="field">
                        <label for="encrypted_msg">Brief Description</label>
                        <textarea id="encrypted_msg" name="encrypted_message" rows="4" placeholder="Briefly describe why you need encrypted communication..."></textarea>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="form-submit">
                    <button type="submit" class="submit-btn" id="submitBtn">
                        <span class="btn-text">Send Message</span>
                        <span class="btn-loader" style="display: none;">
                            <svg class="spin" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
                            Sending...
                        </span>
                        <svg class="btn-arrow" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
                    </button>
                </div>
            </form>
        </div>

        <!-- Footer Info -->
        <div class="info-cards">
            <div class="info-card">
                <div class="info-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                </div>
                <div>
                    <h4>Response Time</h4>
                    <p>We typically respond within 24-48 hours. Media enquiries with deadlines are prioritized.</p>
                </div>
            </div>
            <div class="info-card">
                <div class="info-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                </div>
                <div>
                    <h4>Your Privacy</h4>
                    <p>We never share contact information with third parties. Anonymous tips remain truly anonymous.</p>
                </div>
            </div>
        </div>

    </div>
</section>

<style>
/* Base */
.contact-page {
    min-height: 100vh;
    background: #fafafa;
    padding: 80px 24px;
}

.contact-container {
    max-width: 720px;
    margin: 0 auto;
}

/* Header */
.contact-header {
    text-align: center;
    margin-bottom: 48px;
    margin-top: 40px;
}

.header-badge {
    display: inline-block;
    padding: 6px 14px;
    background: #f0f0f0;
    border-radius: 100px;
    font-size: 0.8rem;
    font-weight: 500;
    color: #666;
    margin-bottom: 16px;
}

.contact-header h1 {
    font-size: 2.25rem;
    font-weight: 700;
    color: #1a1a1a;
    margin: 0 0 12px 0;
    letter-spacing: -0.5px;
}

.contact-header p {
    font-size: 1rem;
    color: #666;
    margin: 0;
    line-height: 1.6;
}

/* Inquiry Type Cards */
.inquiry-cards {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-bottom: 32px;
}

.inquiry-card {
    display: flex;
    align-items: flex-start;
    gap: 14px;
    padding: 18px;
    background: #fff;
    border: 1.5px solid #e8e8e8;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.inquiry-card:hover {
    border-color: #d0d0d0;
}

.inquiry-card.active {
    border-color: #1a1a1a;
    background: #fff;
}

.card-radio {
    width: 18px;
    height: 18px;
    border: 2px solid #ccc;
    border-radius: 50%;
    flex-shrink: 0;
    margin-top: 2px;
    position: relative;
    transition: all 0.2s;
}

.inquiry-card.active .card-radio {
    border-color: #1a1a1a;
}

.inquiry-card.active .card-radio::after {
    content: '';
    position: absolute;
    top: 3px;
    left: 3px;
    width: 8px;
    height: 8px;
    background: #1a1a1a;
    border-radius: 50%;
}

.card-icon {
    width: 42px;
    height: 42px;
    background: #f5f5f5;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    color: #555;
}

.inquiry-card.active .card-icon {
    background: #1a1a1a;
    color: #fff;
}

.card-content h3 {
    font-size: 0.95rem;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0 0 4px 0;
}

.card-content p {
    font-size: 0.8rem;
    color: #888;
    margin: 0;
    line-height: 1.4;
}

/* Form Wrapper */
.form-wrapper {
    background: #fff;
    border: 1px solid #e8e8e8;
    border-radius: 16px;
    padding: 36px;
    margin-bottom: 32px;
}

.form-section {
    display: none;
}

.form-section.active {
    display: block;
}

.section-intro {
    margin-bottom: 32px;
}

.section-intro h2 {
    font-size: 1.35rem;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0 0 6px 0;
}

.section-intro p {
    font-size: 0.9rem;
    color: #777;
    margin: 0;
}

/* Fields */
.fields-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

.field {
    margin-bottom: 24px;
}

.field label {
    display: block;
    font-size: 0.85rem;
    font-weight: 500;
    color: #333;
    margin-bottom: 8px;
}

.field label .optional {
    font-weight: 400;
    color: #aaa;
    font-size: 0.8rem;
}

.field input[type="text"],
.field input[type="email"],
.field input[type="tel"],
.field input[type="datetime-local"],
.field textarea,
.select-input {
    width: 100%;
    padding: 14px 16px;
    border: 1.5px solid #e0e0e0;
    border-radius: 10px;
    font-size: 0.95rem;
    color: #1a1a1a;
    background: #fff;
    transition: all 0.2s;
    outline: none;
}

.field input::placeholder,
.field textarea::placeholder,
.select-input::placeholder {
    color: #aaa;
}

.field input:focus,
.field textarea:focus,
.select-input:focus,
.select-wrapper.open .select-input {
    border-color: #1a1a1a;
}

.field textarea {
    resize: vertical;
    min-height: 100px;
    line-height: 1.5;
}

.field-hint {
    font-size: 0.8rem;
    color: #888;
    margin: 8px 0 0 0;
}

/* Custom Select */
.select-wrapper {
    position: relative;
}

.select-input {
    cursor: pointer;
    padding-right: 44px;
}

.select-arrow {
    position: absolute;
    right: 14px;
    top: 50%;
    transform: translateY(-50%);
    color: #888;
    pointer-events: none;
    transition: transform 0.2s;
}

.select-wrapper.open .select-arrow {
    transform: translateY(-50%) rotate(180deg);
}

.select-dropdown {
    position: absolute;
    top: calc(100% + 6px);
    left: 0;
    right: 0;
    background: #fff;
    border: 1.5px solid #e0e0e0;
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.1);
    z-index: 100;
    display: none;
    overflow: hidden;
}

.select-wrapper.open .select-dropdown {
    display: block;
}

.select-option {
    padding: 12px 16px;
    font-size: 0.9rem;
    color: #333;
    cursor: pointer;
    transition: background 0.15s;
}

.select-option:hover {
    background: #f5f5f5;
}

.select-option.selected {
    background: #f0f0f0;
    font-weight: 500;
}

/* Toggle Switch */
.toggle-label {
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    font-weight: 500;
}

.toggle-switch {
    position: relative;
    width: 48px;
    height: 26px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: #ddd;
    border-radius: 26px;
    transition: 0.3s;
}

.toggle-slider::before {
    position: absolute;
    content: "";
    height: 20px;
    width: 20px;
    left: 3px;
    bottom: 3px;
    background: white;
    border-radius: 50%;
    transition: 0.3s;
    box-shadow: 0 2px 4px rgba(0,0,0,0.15);
}

.toggle-switch input:checked + .toggle-slider {
    background: #1a1a1a;
}

.toggle-switch input:checked + .toggle-slider::before {
    transform: translateX(22px);
}

/* Urgency Options */
.urgency-options {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.urgency-item {
    cursor: pointer;
}

.urgency-item input {
    display: none;
}

.urgency-label {
    display: inline-block;
    padding: 10px 18px;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 500;
    transition: all 0.2s;
    border: 1.5px solid transparent;
}

.urgency-label.low { background: #f5f5f5; color: #666; }
.urgency-label.normal { background: #e8f4fd; color: #1a73e8; }
.urgency-label.high { background: #fff3e0; color: #e65100; }
.urgency-label.critical { background: #ffebee; color: #c62828; }

.urgency-item input:checked + .urgency-label {
    border-color: currentColor;
}

/* Info Boxes */
.info-box {
    display: flex;
    gap: 14px;
    padding: 16px;
    border-radius: 10px;
    margin-bottom: 24px;
}

.info-box.security {
    background: #e8f5e9;
    color: #2e7d32;
}

.info-box svg {
    flex-shrink: 0;
    margin-top: 2px;
}

.info-box strong {
    display: block;
    font-size: 0.9rem;
    margin-bottom: 4px;
}

.info-box p {
    font-size: 0.8rem;
    margin: 0;
    opacity: 0.85;
    line-height: 1.5;
}

/* Secure Channels */
.secure-channels {
    background: #f8f8f8;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 28px;
}

.secure-channels h4 {
    font-size: 0.85rem;
    font-weight: 600;
    color: #555;
    margin: 0 0 16px 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.channels-list {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
}

.channel {
    display: flex;
    align-items: center;
    gap: 10px;
}

.channel-badge {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
}

.channel-badge.signal { background: #3a76f0; }
.channel-badge.proton { background: #8b5cf6; }
.channel-badge.session { background: #00c853; }

.channel strong {
    display: block;
    font-size: 0.85rem;
    color: #333;
}

.channel span {
    font-size: 0.75rem;
    color: #888;
}

/* Submit */
.form-submit {
    margin-top: 32px;
    padding-top: 28px;
    border-top: 1px solid #eee;
}

.submit-btn {
    width: 100%;
    padding: 16px 24px;
    background: #1a1a1a;
    color: #fff;
    border: none;
    border-radius: 10px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.2s;
}

.submit-btn:hover {
    background: #333;
}

.submit-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.btn-arrow {
    transition: transform 0.2s;
}

.submit-btn:hover .btn-arrow {
    transform: translateX(4px);
}

.spin {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Messages */
.form-messages {
    padding: 16px;
    border-radius: 10px;
    margin-bottom: 24px;
    font-size: 0.9rem;
    line-height: 1.5;
}

.form-messages.success {
    background: #e8f5e9;
    color: #2e7d32;
    border: 1px solid #c8e6c9;
}

.form-messages.error {
    background: #ffebee;
    color: #c62828;
    border: 1px solid #ffcdd2;
}

/* Info Cards */
.info-cards {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
}

.info-card {
    display: flex;
    gap: 14px;
    padding: 20px;
    background: #fff;
    border: 1px solid #e8e8e8;
    border-radius: 12px;
}

.info-icon {
    width: 44px;
    height: 44px;
    background: #f5f5f5;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    color: #555;
}

.info-card h4 {
    font-size: 0.9rem;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0 0 4px 0;
}

.info-card p {
    font-size: 0.8rem;
    color: #777;
    margin: 0;
    line-height: 1.5;
}

/* Responsive */
@media (max-width: 768px) {
    .contact-page {
        padding: 48px 16px;
    }

    .contact-header h1 {
        font-size: 1.75rem;
    }

    .inquiry-cards {
        grid-template-columns: 1fr;
    }

    .form-wrapper {
        padding: 24px 20px;
    }

    .fields-grid {
        grid-template-columns: 1fr;
    }

    .info-cards {
        grid-template-columns: 1fr;
    }

    .urgency-options {
        gap: 8px;
    }

    .urgency-label {
        padding: 8px 14px;
        font-size: 0.8rem;
    }

    .channels-list {
        flex-direction: column;
        gap: 12px;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Inquiry card selection
    const cards = document.querySelectorAll('.inquiry-card');
    const sections = document.querySelectorAll('.form-section');
    const typeInput = document.getElementById('inquiryType');

    cards.forEach(card => {
        card.addEventListener('click', function() {
            const type = this.dataset.type;

            cards.forEach(c => c.classList.remove('active'));
            this.classList.add('active');

            typeInput.value = type;

            sections.forEach(s => s.classList.remove('active'));
            document.getElementById('section-' + type).classList.add('active');

            updateButtonText(type);
        });
    });

    function updateButtonText(type) {
        const btnText = document.querySelector('.btn-text');
        const texts = {
            'general': 'Send Message',
            'media': 'Submit Media Request',
            'secure_tip': 'Submit Tip Securely',
            'encrypted': 'Request Secure Contact'
        };
        btnText.textContent = texts[type] || 'Send Message';
    }

    // Custom select functionality
    document.querySelectorAll('.select-wrapper').forEach(wrapper => {
        const input = wrapper.querySelector('.select-input');
        const hidden = wrapper.querySelector('input[type="hidden"]');
        const dropdown = wrapper.querySelector('.select-dropdown');
        const options = wrapper.querySelectorAll('.select-option');

        input.addEventListener('click', function(e) {
            e.stopPropagation();
            // Close other dropdowns
            document.querySelectorAll('.select-wrapper.open').forEach(w => {
                if (w !== wrapper) w.classList.remove('open');
            });
            wrapper.classList.toggle('open');
        });

        options.forEach(opt => {
            opt.addEventListener('click', function() {
                const value = this.dataset.value;
                const text = this.textContent;

                input.value = text;
                hidden.value = value;

                options.forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');

                wrapper.classList.remove('open');
            });
        });
    });

    // Close dropdowns on outside click
    document.addEventListener('click', function() {
        document.querySelectorAll('.select-wrapper.open').forEach(w => {
            w.classList.remove('open');
        });
    });

    // Form submission
    const form = document.getElementById('contactForm');
    const submitBtn = document.getElementById('submitBtn');
    const messagesDiv = document.getElementById('formMessages');

    form.addEventListener('submit', async function(e) {
        e.preventDefault();

        submitBtn.disabled = true;
        submitBtn.querySelector('.btn-text').style.display = 'none';
        submitBtn.querySelector('.btn-arrow').style.display = 'none';
        submitBtn.querySelector('.btn-loader').style.display = 'flex';

        try {
            const formData = new FormData(form);
            const response = await fetch(form.action, {
                method: 'POST',
                body: formData,
                headers: { 'X-Requested-With': 'XMLHttpRequest' }
            });

            const data = await response.json();

            if (data.success) {
                messagesDiv.className = 'form-messages success';
                messagesDiv.innerHTML = data.message;
                if (data.reference_code) {
                    messagesDiv.innerHTML += '<br><strong>Reference Code: ' + data.reference_code + '</strong><br>Save this code to check for responses.';
                }
                messagesDiv.style.display = 'block';
                form.reset();
                cards[0].click();
            } else {
                messagesDiv.className = 'form-messages error';
                messagesDiv.innerHTML = data.errors ? data.errors.join('<br>') : 'An error occurred. Please try again.';
                messagesDiv.style.display = 'block';
            }
        } catch (error) {
            messagesDiv.className = 'form-messages error';
            messagesDiv.innerHTML = 'Network error. Please check your connection and try again.';
            messagesDiv.style.display = 'block';
        } finally {
            submitBtn.disabled = false;
            submitBtn.querySelector('.btn-text').style.display = 'inline';
            submitBtn.querySelector('.btn-arrow').style.display = 'block';
            submitBtn.querySelector('.btn-loader').style.display = 'none';
        }

        messagesDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
    });
});

// Toggle anonymous fields
function toggleAnonymousFields() {
    const isAnonymous = document.getElementById('isAnonymous').checked;
    const contactFields = document.getElementById('tipContactFields');
    contactFields.style.display = isAnonymous ? 'none' : 'block';
}
</script>
{% endblock %}
